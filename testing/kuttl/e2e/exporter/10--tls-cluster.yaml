# Generated certs using openssl
# openssl req -x509 -nodes -newkey ec -pkeyopt ec_paramgen_curve:prime256v1 \
#   -pkeyopt ec_param_enc:named_curve -sha384 -keyout ca.key -out ca.crt \
#   -days 365 -subj "/CN=*"
apiVersion: v1
kind: Secret
metadata:
  name: cluster-cert
type: Opaque
data:
  tls.crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUJiakNDQVJPZ0F3SUJBZ0lVUUU3T0pqRDM5WHUvelZlenZQYjdSQ0ZTcE1Jd0NnWUlLb1pJemowRUF3TXcKRERFS01BZ0dBMVVFQXd3QktqQWVGdzB5TWpFd01USXhPRE14TURoYUZ3MHlNekV3TVRJeE9ETXhNRGhhTUF3eApDakFJQmdOVkJBTU1BU293V1RBVEJnY3Foa2pPUFFJQkJnZ3Foa2pPUFFNQkJ3TkNBQVJjaUYyckNlbmg4UFFLClZGUWJaRVcvWi9XUGgwZkk1aHhVb1ZkVVpuRTBTNGhCK1U3aGV5L3QvQVJNbDF3cXovazQ0cmlBa1g1ckFMakgKei9hTm16bnJvMU13VVRBZEJnTlZIUTRFRmdRVTQvUFc2MEdUcWFQdGpYWXdsMk56d0RGMFRmY3dId1lEVlIwagpCQmd3Rm9BVTQvUFc2MEdUcWFQdGpYWXdsMk56d0RGMFRmY3dEd1lEVlIwVEFRSC9CQVV3QXdFQi96QUtCZ2dxCmhrak9QUVFEQXdOSkFEQkdBaUVBbG9iemo3Uml4NkU0OW8yS2JjOUdtYlRSbWE1SVdGb0k4Uk1zcGZDQzVOUUMKSVFET0hzLzhLNVkxeWhoWDc3SGIxSUpsdnFaVVNjdm5NTjBXeS9JUWRuemJ4QT09Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K
  tls.key: LS0tLS1CRUdJTiBQUklWQVRFIEtFWS0tLS0tCk1JR0hBZ0VBTUJNR0J5cUdTTTQ5QWdFR0NDcUdTTTQ5QXdFSEJHMHdhd0lCQVFRZ1preDQ4cktidnZtUVRLSC8KSTN4STZzYW45Wk55MjQrOUQ4ODd5a2svb1l1aFJBTkNBQVJjaUYyckNlbmg4UFFLVkZRYlpFVy9aL1dQaDBmSQo1aHhVb1ZkVVpuRTBTNGhCK1U3aGV5L3QvQVJNbDF3cXovazQ0cmlBa1g1ckFMakh6L2FObXpucgotLS0tLUVORCBQUklWQVRFIEtFWS0tLS0tCg==
---
apiVersion: postgres-operator.crunchydata.com/v1beta1
kind: PostgresCluster
metadata:
  name: exporter-tls
spec:
  postgresVersion: ${KUTTL_PG_VERSION}
  instances:
    - name: instance1
      dataVolumeClaimSpec:
        accessModes:
        - "ReadWriteOnce"
        resources:
          requests:
            storage: 1Gi
  backups:
    pgbackrest:
      repos:
      - name: repo1
        volume:
          volumeClaimSpec:
            accessModes:
            - "ReadWriteOnce"
            resources:
              requests:
                storage: 1Gi
  monitoring:
    pgmonitor:
      exporter:
        customTLSSecret:
          name: cluster-cert
